<ossec_config>
  <!-- ===============================
       🔧 Global Configuration
       =============================== -->
  <global>
    <jsonout_output>yes</jsonout_output>
    <alerts_log>yes</alerts_log>
    <logall>no</logall>
    <logall_json>no</logall_json>
    <email_notification>no</email_notification>

    <!-- Agent disconnection thresholds -->
    <agents_disconnection_time>10m</agents_disconnection_time>
    <agents_disconnection_alert_time>0</agents_disconnection_alert_time>
  </global>

  <!-- ===============================
       🧠 Alert Settings
       =============================== -->
  <alerts>
    <log_alert_level>3</log_alert_level>
  </alerts>

  <!-- ===============================
       🪵 Logging Format
       =============================== -->
  <logging>
    <log_format>plain</log_format>
  </logging>

  <!-- ===============================
       🌐 Agent Connection
       =============================== -->
  <remote>
    <connection>secure</connection>
    <port>1514</port>
    <protocol>tcp</protocol>
    <queue_size>131072</queue_size>
  </remote>

  <!-- ===============================
       🧱 File Integrity Monitoring (Syscheck)
       =============================== -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>43200</frequency> <!-- every 12h -->
    <scan_on_start>yes</scan_on_start>
    <alert_new_files>yes</alert_new_files>

    <directories>/etc,/usr/bin,/usr/sbin,/bin,/sbin,/boot</directories>

    <!-- Ignore unnecessary files -->
    <ignore>/etc/mtab</ignore>
    <ignore>/etc/random-seed</ignore>
    <ignore>/etc/adjtime</ignore>
    <ignore type="sregex">.log$|.swp$</ignore>

    <skip_nfs>yes</skip_nfs>
    <skip_dev>yes</skip_dev>
    <skip_proc>yes</skip_proc>
    <skip_sys>yes</skip_sys>
  </syscheck>

  <!-- ===============================
       🧩 Ruleset Configuration
       =============================== -->
  <ruleset>
    <!-- Default Wazuh rules -->
    <decoder_dir>ruleset/decoders</decoder_dir>
    <rule_dir>ruleset/rules</rule_dir>

    <!-- Custom rules -->
    <decoder_dir>etc/decoders</decoder_dir>
    <rule_dir>etc/rules</rule_dir>
  </ruleset>

  <!-- ===============================
       📦 Local Log Collection
       =============================== -->
  <localfile>
    <log_format>command</log_format>
    <command>df -P</command>
    <frequency>360</frequency>
  </localfile>

  <localfile>
    <log_format>full_command</log_format>
    <command>netstat -tulpn</command>
    <frequency>360</frequency>
  </localfile>

  <!-- ===============================
       🔔 Discord Integration
       =============================== -->
  <integration>
    <name>custom-discord</name>
    <!-- Webhook URL은 .env 파일에 분리 -->
    <hook_url>${DISCORD_WEBHOOK}</hook_url>
    <alert_format>json</alert_format>
    <rule_id>100100,100200,100300</rule_id>
    <duplicates>no</duplicates>
  </integration>

</ossec_config>
